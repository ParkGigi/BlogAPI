import datetime
import json


def jsonify(obj):
    def jsonify_dict(d):
        for key, val in d.items():
            if isinstance(val, bytes):
                d[key] = val.decode()
            elif isinstance(val, datetime.datetime):
                d[key] = val.isoformat()
        return d

    if isinstance(obj, dict):
        obj = jsonify_dict(obj)
    elif isinstance(obj, list):
        obj = list(map(jsonify_dict, obj))

    return json.dumps(obj)
